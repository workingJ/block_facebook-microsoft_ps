New-NetFirewallRule -Name "111 Block microsoft (in)" `
                -Description "Kill all microsoft ip ranges" `
                -DisplayName "111 Block microsoft (in)" `
                -Enabled True `
                -Profile Any `
                -Direction Inbound `
                -Action Block `
                -RemoteAddress("104.44.65.0/24",
"104.44.70.0/24",
"104.44.73.0/24",
"13.107.12.0/24",
"13.107.128.0/24",
"13.107.129.0/24",
"13.107.13.0/24",
"13.107.136.0/24",
"13.107.137.0/24",
"13.107.138.0/24",
"13.107.139.0/24",
"13.107.140.0/24",
"13.107.15.0/24",
"13.107.16.0/24",
"13.107.160.0/24",
"13.107.18.0/24",
"13.107.19.0/24",
"13.107.202.0/24",
"13.107.204.0/24",
"13.107.208.0/24",
"13.107.21.0/24",
"13.107.213.0/24",
"13.107.22.0/24",
"13.107.220.0/24",
"13.107.224.0/24",
"13.107.226.0/24",
"13.107.24.0/24",
"13.107.246.0/24",
"13.107.253.0/24",
"13.107.254.0/24",
"13.107.3.0/24",
"13.107.39.0/24",
"13.107.4.0/24",
"13.107.40.0/24",
"13.107.42.0/24",
"13.107.43.0/24",
"13.107.44.0/24",
"13.107.46.0/24",
"13.107.47.0/24",
"13.107.48.0/24",
"13.107.49.0/24",
"13.107.5.0/24",
"13.107.50.0/24",
"13.107.51.0/24",
"13.107.52.0/24",
"13.107.53.0/24",
"13.107.54.0/24",
"13.107.56.0/24",
"13.107.58.0/24",
"13.107.6.0/24",
"13.107.7.0/24",
"13.107.9.0/24",
"131.107.0.0/16",
"131.253.112.0/21",
"131.253.120.0/22",
"131.253.21.0/24",
"131.253.22.0/23",
"131.253.3.0/24",
"131.253.33.0/24",
"131.253.72.0/22",
"131.253.80.0/20",
"150.171.32.0/24",
"150.171.40.0/24",
"150.171.41.0/24",
"150.171.42.0/24",
"150.171.43.0/24",
"150.171.44.0/24",
"157.54.0.0/16",
"157.57.0.0/16",
"157.58.0.0/16",
"157.58.192.0/19",
"157.58.31.0/24",
"157.59.0.0/16",
"157.60.0.0/16",
"167.220.0.0/16",
"167.220.148.0/22",
"167.220.152.0/24",
"167.220.204.0/22",
"167.220.208.0/23",
"192.92.196.0/24",
"194.69.100.0/22",
"194.69.126.0/23",
"194.69.96.0/19",
"194.69.96.0/22",
"195.134.224.0/19",
"198.105.232.0/22",
"199.2.137.0/24",
"20.140.0.0/15",
"20.157.100.0/24",
"20.157.102.0/24",
"20.157.103.0/24",
"20.157.104.0/24",
"20.157.105.0/24",
"20.157.106.0/24",
"20.157.107.0/24",
"20.157.108.0/24",
"20.157.12.0/22",
"20.157.128.0/24",
"20.157.129.0/24",
"20.157.132.0/24",
"20.157.134.0/24",
"20.157.142.0/24",
"20.157.143.0/24",
"20.157.144.0/24",
"20.157.146.0/24",
"20.157.147.0/24",
"20.157.158.0/24",
"20.157.159.0/24",
"20.157.16.0/24",
"20.157.17.0/24",
"20.157.18.0/24",
"20.157.19.0/24",
"20.157.2.0/24",
"20.157.32.0/24",
"20.157.33.0/24",
"20.157.34.0/23",
"20.157.36.0/23",
"20.157.38.0/24",
"20.157.39.0/24",
"20.157.41.0/24",
"20.157.42.0/24",
"20.157.43.0/24",
"20.157.44.0/24",
"20.157.45.0/24",
"20.157.48.0/23",
"20.157.50.0/23",
"20.157.53.0/24",
"20.157.54.0/24",
"20.157.55.0/24",
"20.157.57.0/24",
"20.157.58.0/24",
"20.157.59.0/24",
"20.157.6.0/23",
"20.157.60.0/24",
"20.157.62.0/23",
"20.157.96.0/24",
"20.157.97.0/24",
"20.157.98.0/24",
"20.157.99.0/24",
"20.34.0.0/15",
"20.39.58.0/23",
"20.47.1.0/24",
"20.47.10.0/24",
"20.47.100.0/24",
"20.47.101.0/24",
"20.47.102.0/24",
"20.47.103.0/24",
"20.47.104.0/24",
"20.47.105.0/24",
"20.47.106.0/24",
"20.47.107.0/24",
"20.47.108.0/24",
"20.47.109.0/24",
"20.47.11.0/24",
"20.47.110.0/24",
"20.47.111.0/24",
"20.47.112.0/24",
"20.47.113.0/24",
"20.47.114.0/24",
"20.47.115.0/24",
"20.47.116.0/24",
"20.47.117.0/24",
"20.47.118.0/24",
"20.47.119.0/24",
"20.47.12.0/24",
"20.47.120.0/23",
"20.47.122.0/23",
"20.47.124.0/23",
"20.47.126.0/23",
"20.47.13.0/24",
"20.47.14.0/24",
"20.47.15.0/24",
"20.47.16.0/23",
"20.47.18.0/23",
"20.47.2.0/24",
"20.47.20.0/23",
"20.47.22.0/23",
"20.47.24.0/23",
"20.47.26.0/24",
"20.47.27.0/24",
"20.47.28.0/24",
"20.47.29.0/24",
"20.47.3.0/24",
"20.47.30.0/24",
"20.47.31.0/24",
"20.47.32.0/24",
"20.47.33.0/24",
"20.47.34.0/24",
"20.47.37.0/24",
"2001:4898::/32",
"2001:489a:2000::/35",
"2001:489a:4000::/35",
"204.13.120.0/21",
"204.14.180.0/24",
"204.182.144.0/24",
"204.255.244.0/23",
"204.79.180.0/24",
"204.79.197.0/24",
"2404:f801::/32",
"2620:1ec:12::/48",
"2620:1ec:13::/48",
"2620:1ec:1d::/48",
"2620:1ec:21::/48",
"2620:1ec:22::/48",
"2620:1ec:23::/48",
"2620:1ec:24::/48",
"2620:1ec:28::/48",
"2620:1ec:29::/48",
"2620:1ec:34::/48",
"2a01:110:8068::/48",
"2a01:110::/32",
"2a01:110:e050::/48",
"40.66.93.0/24",
"40.90.4.0/24",
"52.113.194.0/24",
"52.113.195.0/24",
"52.113.196.0/24",
"52.113.197.0/24",
"52.126.0.0/15",
"64.4.48.0/24",
"65.53.0.0/16",
"65.54.198.0/24",
"65.54.207.0/24",
"65.54.215.0/24")
New-NetFirewallRule -Name "111 Block microsoft (out)" `
                -Description "Kill all microsoft ip ranges" `
                -DisplayName "111 Block microsoft (out)" `
                -Enabled True `
                -Profile Any `
                -Direction Outbound `
                -Action Block `
                -RemoteAddress ("104.44.65.0/24",
"104.44.70.0/24",
"104.44.73.0/24",
"13.107.12.0/24",
"13.107.128.0/24",
"13.107.129.0/24",
"13.107.13.0/24",
"13.107.136.0/24",
"13.107.137.0/24",
"13.107.138.0/24",
"13.107.139.0/24",
"13.107.140.0/24",
"13.107.15.0/24",
"13.107.16.0/24",
"13.107.160.0/24",
"13.107.18.0/24",
"13.107.19.0/24",
"13.107.202.0/24",
"13.107.204.0/24",
"13.107.208.0/24",
"13.107.21.0/24",
"13.107.213.0/24",
"13.107.22.0/24",
"13.107.220.0/24",
"13.107.224.0/24",
"13.107.226.0/24",
"13.107.24.0/24",
"13.107.246.0/24",
"13.107.253.0/24",
"13.107.254.0/24",
"13.107.3.0/24",
"13.107.39.0/24",
"13.107.4.0/24",
"13.107.40.0/24",
"13.107.42.0/24",
"13.107.43.0/24",
"13.107.44.0/24",
"13.107.46.0/24",
"13.107.47.0/24",
"13.107.48.0/24",
"13.107.49.0/24",
"13.107.5.0/24",
"13.107.50.0/24",
"13.107.51.0/24",
"13.107.52.0/24",
"13.107.53.0/24",
"13.107.54.0/24",
"13.107.56.0/24",
"13.107.58.0/24",
"13.107.6.0/24",
"13.107.7.0/24",
"13.107.9.0/24",
"131.107.0.0/16",
"131.253.112.0/21",
"131.253.120.0/22",
"131.253.21.0/24",
"131.253.22.0/23",
"131.253.3.0/24",
"131.253.33.0/24",
"131.253.72.0/22",
"131.253.80.0/20",
"150.171.32.0/24",
"150.171.40.0/24",
"150.171.41.0/24",
"150.171.42.0/24",
"150.171.43.0/24",
"150.171.44.0/24",
"157.54.0.0/16",
"157.57.0.0/16",
"157.58.0.0/16",
"157.58.192.0/19",
"157.58.31.0/24",
"157.59.0.0/16",
"157.60.0.0/16",
"167.220.0.0/16",
"167.220.148.0/22",
"167.220.152.0/24",
"167.220.204.0/22",
"167.220.208.0/23",
"192.92.196.0/24",
"194.69.100.0/22",
"194.69.126.0/23",
"194.69.96.0/19",
"194.69.96.0/22",
"195.134.224.0/19",
"198.105.232.0/22",
"199.2.137.0/24",
"20.140.0.0/15",
"20.157.100.0/24",
"20.157.102.0/24",
"20.157.103.0/24",
"20.157.104.0/24",
"20.157.105.0/24",
"20.157.106.0/24",
"20.157.107.0/24",
"20.157.108.0/24",
"20.157.12.0/22",
"20.157.128.0/24",
"20.157.129.0/24",
"20.157.132.0/24",
"20.157.134.0/24",
"20.157.142.0/24",
"20.157.143.0/24",
"20.157.144.0/24",
"20.157.146.0/24",
"20.157.147.0/24",
"20.157.158.0/24",
"20.157.159.0/24",
"20.157.16.0/24",
"20.157.17.0/24",
"20.157.18.0/24",
"20.157.19.0/24",
"20.157.2.0/24",
"20.157.32.0/24",
"20.157.33.0/24",
"20.157.34.0/23",
"20.157.36.0/23",
"20.157.38.0/24",
"20.157.39.0/24",
"20.157.41.0/24",
"20.157.42.0/24",
"20.157.43.0/24",
"20.157.44.0/24",
"20.157.45.0/24",
"20.157.48.0/23",
"20.157.50.0/23",
"20.157.53.0/24",
"20.157.54.0/24",
"20.157.55.0/24",
"20.157.57.0/24",
"20.157.58.0/24",
"20.157.59.0/24",
"20.157.6.0/23",
"20.157.60.0/24",
"20.157.62.0/23",
"20.157.96.0/24",
"20.157.97.0/24",
"20.157.98.0/24",
"20.157.99.0/24",
"20.34.0.0/15",
"20.39.58.0/23",
"20.47.1.0/24",
"20.47.10.0/24",
"20.47.100.0/24",
"20.47.101.0/24",
"20.47.102.0/24",
"20.47.103.0/24",
"20.47.104.0/24",
"20.47.105.0/24",
"20.47.106.0/24",
"20.47.107.0/24",
"20.47.108.0/24",
"20.47.109.0/24",
"20.47.11.0/24",
"20.47.110.0/24",
"20.47.111.0/24",
"20.47.112.0/24",
"20.47.113.0/24",
"20.47.114.0/24",
"20.47.115.0/24",
"20.47.116.0/24",
"20.47.117.0/24",
"20.47.118.0/24",
"20.47.119.0/24",
"20.47.12.0/24",
"20.47.120.0/23",
"20.47.122.0/23",
"20.47.124.0/23",
"20.47.126.0/23",
"20.47.13.0/24",
"20.47.14.0/24",
"20.47.15.0/24",
"20.47.16.0/23",
"20.47.18.0/23",
"20.47.2.0/24",
"20.47.20.0/23",
"20.47.22.0/23",
"20.47.24.0/23",
"20.47.26.0/24",
"20.47.27.0/24",
"20.47.28.0/24",
"20.47.29.0/24",
"20.47.3.0/24",
"20.47.30.0/24",
"20.47.31.0/24",
"20.47.32.0/24",
"20.47.33.0/24",
"20.47.34.0/24",
"20.47.37.0/24",
"2001:4898::/32",
"2001:489a:2000::/35",
"2001:489a:4000::/35",
"204.13.120.0/21",
"204.14.180.0/24",
"204.182.144.0/24",
"204.255.244.0/23",
"204.79.180.0/24",
"204.79.197.0/24",
"2404:f801::/32",
"2620:1ec:12::/48",
"2620:1ec:13::/48",
"2620:1ec:1d::/48",
"2620:1ec:21::/48",
"2620:1ec:22::/48",
"2620:1ec:23::/48",
"2620:1ec:24::/48",
"2620:1ec:28::/48",
"2620:1ec:29::/48",
"2620:1ec:34::/48",
"2a01:110:8068::/48",
"2a01:110::/32",
"2a01:110:e050::/48",
"40.66.93.0/24",
"40.90.4.0/24",
"52.113.194.0/24",
"52.113.195.0/24",
"52.113.196.0/24",
"52.113.197.0/24",
"52.126.0.0/15",
"64.4.48.0/24",
"65.53.0.0/16",
"65.54.198.0/24",
"65.54.207.0/24",
"65.54.215.0/24")